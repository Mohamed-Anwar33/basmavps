import mongoose from 'mongoose';
import Service from '../src/models/Service.js';
import dotenv from 'dotenv';

// ØªØ­Ù…ÙŠÙ„ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
dotenv.config();

// Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/basma-design');
  } catch (error) {
    process.exit(1);
  }
};

// Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
const extractRealContent = async () => {
  try {
    
    const services = await Service.find({});
    
    for (const service of services) {
      try {
        
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¦Ø© ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù†
        const realContent = getRealContentForService(service);
        
        // ØªØ­Ø¯ÙŠØ« Ø¬Ø²Ø¦ÙŠ Ø¢Ù…Ù† Ù„Ø­Ù‚Ù„ uiTexts ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† ØªØ´ØºÙŠÙ„ ÙƒÙ„ Ø§Ù„ÙØ§Ù„Ø¯ÙŠØ´Ù†
        await Service.updateOne(
          { _id: service._id },
          {
            $set: {
              'uiTexts.shortDescription': realContent.shortDescription,
              'uiTexts.workSteps': realContent.workSteps,
              'uiTexts.customFeatures': realContent.customFeatures,
            },
          },
          { runValidators: false }
        );
        
      } catch (svcErr) {
        continue;
      }
    }
    
    
  } catch (error) {
  }
};

// Ø¯Ø§Ù„Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„ÙƒÙ„ Ø®Ø¯Ù…Ø©
const getRealContentForService = (service) => {
  const category = service.category;
  const title = service.title.ar.toLowerCase();
  
  // Ù†Ø¨Ø°Ø© Ù…Ø®ØªØµØ±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
  const shortDescription = service.description.ar.length > 150 
    ? service.description.ar.substring(0, 150).trim() + '...'
    : service.description.ar;
  
  // Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹
  const workSteps = [
    { 
      title: "Ø§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„", 
      desc: "Ù†Ù‚ÙˆÙ… Ø¨Ø¯Ø±Ø§Ø³Ø© Ù…ØªØ·Ù„Ø¨Ø§ØªÙƒ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ù„ÙˆØ¶Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¹Ù…Ù„ ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…Ø­Ø¯Ø¯Ø©" 
    },
    { 
      title: "Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„ØªÙ†ÙÙŠØ°", 
      desc: "Ù†Ø¨Ø¯Ø£ ÙÙŠ ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù…Ø¹ Ø§Ù„Ø­Ø±Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¥Ø¨Ø¯Ø§Ø¹" 
    },
    { 
      title: "Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªØ³Ù„ÙŠÙ…", 
      desc: "Ù†Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø¹Ù†Ø§ÙŠØ© ÙˆÙ†ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø·Ø§Ø¨Ù‚ØªÙ‡ Ù„Ù„Ù…ÙˆØ§ØµÙØ§Øª Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ" 
    }
  ];
  
  // Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙØ¦Ø© Ø§Ù„Ø®Ø¯Ù…Ø©
  let customFeatures = [];
  
  if (category === 'social-media' || title.includes('Ø³ÙˆØ´ÙŠØ§Ù„') || title.includes('Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª')) {
    customFeatures = [
      { icon: 'ðŸ“±', color: 'pink', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ©', desc: 'Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ Ø¨Ø£Ø¹Ù„Ù‰ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©' },
      { icon: 'ðŸ“Š', color: 'orange', title: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', desc: 'ØªØ­Ù„ÙŠÙ„ Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬' },
      { icon: 'ðŸŽ¯', color: 'teal', title: 'Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¯Ù‚ÙŠÙ‚', desc: 'Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ ÙˆØ§Ù„ÙˆØµÙˆÙ„' },
      { icon: 'âš¡', color: 'purple', title: 'Ù†ØªØ§Ø¦Ø¬ Ø³Ø±ÙŠØ¹Ø©', desc: 'ØªØ­Ù‚ÙŠÙ‚ Ù†ØªØ§Ø¦Ø¬ Ù…Ù„Ù…ÙˆØ³Ø© ÙÙŠ ÙˆÙ‚Øª Ù‚ØµÙŠØ± Ù…Ø¹ Ù†Ù…Ùˆ Ù…Ø³ØªÙ…Ø±' }
    ];
  } else if (category === 'logos' || title.includes('Ø´Ø¹Ø§Ø±') || title.includes('Ù„ÙˆØ¬Ùˆ')) {
    customFeatures = [
      { icon: 'ðŸŽ¨', color: 'blue', title: 'ØªØµÙ…ÙŠÙ… Ù…Ù…ÙŠØ²', desc: 'ØªØµØ§Ù…ÙŠÙ… Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© ØªØ¹ÙƒØ³ Ù‡ÙˆÙŠØ© Ø¹Ù„Ø§Ù…ØªÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ' },
      { icon: 'âœ¨', color: 'green', title: 'Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©', desc: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„Ù…ÙŠØ© ÙÙŠ Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ' },
      { icon: 'ðŸš€', color: 'red', title: 'ØªØ³Ù„ÙŠÙ… Ø³Ø±ÙŠØ¹', desc: `ØªØ³Ù„ÙŠÙ… Ø®Ù„Ø§Ù„ ${service.deliveryTime?.min || 1}-${service.deliveryTime?.max || 4} Ø£ÙŠØ§Ù… Ø¹Ù…Ù„` },
      { icon: 'ðŸ”„', color: 'indigo', title: 'ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ©', desc: `${service.revisions || 2} ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ© Ø­ØªÙ‰ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©` }
    ];
  } else if (category === 'resumes' || title.includes('Ø³ÙŠØ±Ø©') || title.includes('cv')) {
    customFeatures = [
      { icon: 'ðŸ“„', color: 'blue', title: 'ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ', desc: 'Ù‚ÙˆØ§Ù„Ø¨ Ø³ÙŠØ±Ø© Ø°Ø§ØªÙŠØ© Ø¹ØµØ±ÙŠØ© ØªØ¬Ø°Ø¨ Ø§Ù†ØªØ¨Ø§Ù‡ Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¹Ù…Ù„' },
      { icon: 'âš¡', color: 'green', title: 'Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„', desc: 'Ù…Ù„ÙØ§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø³Ù‡ÙˆÙ„Ø© Ø¹Ù„Ù‰ Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø®ØªÙ„ÙØ©' },
      { icon: 'ðŸŽ¯', color: 'orange', title: 'Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ÙˆØ¸Ø§Ø¦Ù', desc: 'ØªØµØ§Ù…ÙŠÙ… Ù…Ø®ØµØµØ© Ù„Ù…Ø®ØªÙ„Ù Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ©' },
      { icon: 'ðŸ“±', color: 'purple', title: 'Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„ØµÙŠØº', desc: 'Ù…ØªÙˆÙØ± Ø¨ØµÙŠØº Ù…Ø®ØªÙ„ÙØ© PDF, Word, PSD Ù„Ù„Ù…Ø±ÙˆÙ†Ø© ÙÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…' }
    ];
  } else if (category === 'linkedin' || title.includes('Ù„ÙŠÙ†ÙƒØ¯')) {
    customFeatures = [
      { icon: 'ðŸ’¼', color: 'blue', title: 'Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ø¹Ø§Ù„ÙŠØ©', desc: 'ØªØ­Ø³ÙŠÙ† Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ Ù„ÙŠØ¸Ù‡Ø± Ø¨Ø´ÙƒÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ ÙŠØ¬Ø°Ø¨ Ø§Ù„ÙØ±Øµ' },
      { icon: 'ðŸŽ¯', color: 'green', title: 'Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¯Ù‚ÙŠÙ‚', desc: 'ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø¸Ù‡ÙˆØ± ÙÙŠ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©' },
      { icon: 'ðŸ“ˆ', color: 'orange', title: 'Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±', desc: 'ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¸Ù‡ÙˆØ± ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ' },
      { icon: 'ðŸš€', color: 'purple', title: 'ÙØ±Øµ Ø£ÙƒØ«Ø±', desc: 'Ø¬Ø°Ø¨ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„ÙØ±Øµ Ø§Ù„Ù…Ù‡Ù†ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø®Ø¨Ø±Ø§ØªÙƒ' }
    ];
  } else if (category === 'banners' || title.includes('Ø¨Ù†Ø±') || title.includes('Ø¥Ø¹Ù„Ø§Ù†')) {
    customFeatures = [
      { icon: 'ðŸŽ¨', color: 'pink', title: 'ØªØµÙ…ÙŠÙ… Ø¬Ø°Ø§Ø¨', desc: 'ØªØµØ§Ù…ÙŠÙ… Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ù…Ø¨ØªÙƒØ±Ø© ØªØ¬Ø°Ø¨ Ø§Ù†ØªØ¨Ø§Ù‡ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù' },
      { icon: 'ðŸ“±', color: 'blue', title: 'Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØµØ§Øª', desc: 'ØªØµØ§Ù…ÙŠÙ… Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø±Ù‚Ù…ÙŠ' },
      { icon: 'âš¡', color: 'orange', title: 'ØªØ£Ø«ÙŠØ± Ù‚ÙˆÙŠ', desc: 'Ø±Ø³Ø§Ø¦Ù„ Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…Ø¤Ø«Ø±Ø© ØªØ­Ù‚Ù‚ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ©' },
      { icon: 'ðŸŽ¯', color: 'green', title: 'Ù†ØªØ§Ø¦Ø¬ Ù…Ø¶Ù…ÙˆÙ†Ø©', desc: 'ØªØµØ§Ù…ÙŠÙ… Ù…Ø¯Ø±ÙˆØ³Ø© ØªØ²ÙŠØ¯ Ù…Ù† Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª' }
    ];
  } else if (category === 'content' || title.includes('Ù…Ø­ØªÙˆ') || title.includes('ÙƒØªØ§Ø¨Ø©')) {
    customFeatures = [
      { icon: 'âœï¸', color: 'blue', title: 'ÙƒØªØ§Ø¨Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ©', desc: 'Ù…Ø­ØªÙˆÙ‰ ØªØ³ÙˆÙŠÙ‚ÙŠ Ù…ÙƒØªÙˆØ¨ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠ ÙŠØ¬Ø°Ø¨ ÙˆÙŠØ¤Ø«Ø±' },
      { icon: 'ðŸŽ¯', color: 'green', title: 'Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¯Ù‚ÙŠÙ‚', desc: 'Ù…Ø­ØªÙˆÙ‰ Ù…Ø®ØµØµ ÙŠØ®Ø§Ø·Ø¨ Ø¬Ù…Ù‡ÙˆØ±Ùƒ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ø¨ÙØ¹Ø§Ù„ÙŠØ©' },
      { icon: 'ðŸ“ˆ', color: 'orange', title: 'Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙØ§Ø¹Ù„', desc: 'Ù…Ø­ØªÙˆÙ‰ ÙŠØ­ÙØ² Ø¹Ù„Ù‰ Ø§Ù„ØªÙØ§Ø¹Ù„ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§Ù„Ø¥Ø¹Ø¬Ø§Ø¨' },
      { icon: 'âš¡', color: 'purple', title: 'ØªØ£Ø«ÙŠØ± ÙÙˆØ±ÙŠ', desc: 'ÙƒÙ„Ù…Ø§Øª Ù…Ø¤Ø«Ø±Ø© ØªØ­Ù‚Ù‚ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ø³Ø±Ø¹Ø©' }
    ];
  } else {
    // Ù…Ù…ÙŠØ²Ø§Øª Ø¹Ø§Ù…Ø© Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
    customFeatures = [
      { icon: 'âœ¨', color: 'blue', title: 'Ø¬ÙˆØ¯Ø© Ù…ØªÙ…ÙŠØ²Ø©', desc: 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø© Ø¨Ø£Ø¹Ù„Ù‰ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©' },
      { icon: 'ðŸš€', color: 'green', title: 'ØªØ³Ù„ÙŠÙ… Ø³Ø±ÙŠØ¹', desc: `Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¹Ù…Ù„ ÙˆØªØ³Ù„ÙŠÙ…Ù‡ ÙÙŠ Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ${service.deliveryTime?.min || 1}-${service.deliveryTime?.max || 7} Ø£ÙŠØ§Ù…` },
      { icon: 'ðŸŽ¯', color: 'orange', title: 'Ø­Ù„ÙˆÙ„ Ù…Ø®ØµØµØ©', desc: 'Ø­Ù„ÙˆÙ„ Ù…ØµÙ…Ù…Ø© Ø®ØµÙŠØµØ§Ù‹ Ù„ØªÙ„Ø¨ÙŠØ© Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ÙØ±ÙŠØ¯Ø©' },
      { icon: 'ðŸ”„', color: 'purple', title: 'Ø¯Ø¹Ù… Ù…Ø³ØªÙ…Ø±', desc: `${service.revisions || 2} ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ø¹ Ø¯Ø¹Ù… ÙÙ†ÙŠ Ù…ØªÙˆØ§ØµÙ„` }
    ];
  }
  
  return {
    shortDescription,
    workSteps,
    customFeatures
  };
};

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠÙ¾Øª
const runScript = async () => {
  try {
    await connectDB();
    await extractRealContent();
  } catch (error) {
  } finally {
    await mongoose.disconnect();
    process.exit(0);
  }
};

runScript();
